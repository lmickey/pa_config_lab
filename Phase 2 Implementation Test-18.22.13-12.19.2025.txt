
============================================================
Phase 2 Implementation Tests
============================================================

Output will be saved to: Phase 2 Implementation Test-18.22.13-12.19.2025.txt
Error log will be saved to: /home/lindsay/Code/pa_config_lab/api_errors.log


============================================================
Prisma Access Credentials
============================================================
Enter credentials to test against a real tenant.
Press Enter to skip and run structure tests only.

Note: For testing, use tenant tsg: 1570970024
      Use 'Mobile Users' folder for security policy testing.

Test against real tenant? (y/n): Enter TSG ID: Enter API Client ID: 
Credentials provided. Testing against real tenant...

Initializing API client...
✓ API client initialized successfully

============================================================
Test 1: Folder Capture
============================================================
✓ Folder capture module structure correct

  Testing against real tenant...
  ✓ Discovered 13 folders
    - ngfw-shared (default: False)
    - Mobile Users (default: False)
    - Mobile Users Explicit Proxy (default: False)
    - Mobile Users Container (default: False)
    - Colo Connect (default: False)
    - Remote Networks (default: False)
    - Service Connections (default: False)
    - Prisma Access (default: False)
    - All (default: False)
    - Mobile User Container (default: False)
    - Access Agent (default: False)
    - GlobalProtect (default: False)
    - Explicit Proxy (default: False)

  Selected test folder: Mobile Users
    (This folder will be used for subsequent tests)
  ✓ Built folder hierarchy (13 folders)
  ✓ Listed 13 non-default folders for capture

============================================================
Test 2: Snippet Capture
============================================================
✓ Snippet capture module structure correct

  Testing against real tenant...
  ✓ Discovered 27 snippets

  Snippet discovery validation:
    ✓ Successfully discovered 27 snippet(s)

  Discovered snippets:
    - predefined-snippet (type: Unknown)
    - default (type: predefined)
    - optional-default (type: predefined)
    - office365 (type: predefined)
    - proxy (type: predefined)
    ... and 22 more

============================================================
Test 3: Rule Capture
============================================================
✓ Rule capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  ✓ Captured 22 rules from Mobile Users

  Rule capture validation:
    ✓ Successfully captured 22 rule(s)

  Example rule details:
    Name: Default Category Block
    Action: allow
    Position: pre
    Source: ['any']
    Destination: []

============================================================
Test 4: Object Capture
============================================================
✓ Object capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  ✓ Captured 5 address objects
  ✓ Captured 1 address groups
Capturing objects from folder: Mobile Users
  Captured 211 objects
    address_objects: 5
    address_groups: 1
    service_objects: 5
    applications: 200
  ✓ Captured 211 total objects

  Object capture breakdown:
    address_objects: 5
    address_groups: 1
    service_objects: 5
    service_groups: 0
    applications: 200
    application_groups: 0
    application_filters: 0
    url_filtering_categories: 0
    external_dynamic_lists: 0
    fqdn_objects: 0

  Example address_objects object:
    Name: Palo Alto Networks Sinkhole
    Type: ip_netmask
    Description: Palo Alto Networks sinkhole

============================================================
Test 5: Profile Capture
============================================================
✓ Profile capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  ✓ Captured 5 authentication profiles

  Example authentication profile:
    Name: CIE-Okta
    Type: 
Capturing profiles from folder: Mobile Users
Capturing anti_spyware profiles...
  Captured 2 anti_spyware profiles
Capturing dns_security profiles...
  Captured 3 dns_security profiles
Capturing file_blocking profiles...
  Captured 1 file_blocking profiles
Capturing http_header profiles...
  Captured 1 http_header profiles
Capturing profile_groups profiles...
  Captured 6 profile_groups profiles
Capturing url_access profiles...
  Captured 5 url_access profiles
Capturing vulnerability_protection profiles...
  Captured 4 vulnerability_protection profiles
Capturing wildfire_anti_virus profiles...
  Captured 2 wildfire_anti_virus profiles
  Captured 32 profiles
    Authentication: 5
    Security: 24
    Decryption: 3

  Profile capture validation:
    ✓ Authentication profiles: 5
    ✓ Security profiles: 24
    ✓ Decryption profiles: 3
    ✓ Total profiles: 32

  Security profile breakdown:
    anti_spyware: 2
    dns_security: 3
    file_blocking: 1
    http_header: 1
    profile_groups: 6
    url_access: 5
    vulnerability_protection: 4
    wildfire_anti_virus: 2

============================================================
Test 6: Pull Orchestrator
============================================================
✓ Pull orchestrator module structure correct

  Testing against real tenant...
  Testing pull with folder: Mobile Users
    [1/3] Capturing rules from Mobile Users
    [2/3] Capturing objects from Mobile Users
Capturing objects from folder: Mobile Users
  Captured 211 objects
    address_objects: 5
    address_groups: 1
    service_objects: 5
    applications: 200
    [3/3] Capturing profiles from Mobile Users
Capturing profiles from folder: Mobile Users
Capturing anti_spyware profiles...
  Captured 2 anti_spyware profiles
Capturing dns_security profiles...
  Captured 3 dns_security profiles
Capturing file_blocking profiles...
  Captured 1 file_blocking profiles
Capturing http_header profiles...
  Captured 1 http_header profiles
Capturing profile_groups profiles...
  Captured 6 profile_groups profiles
Capturing url_access profiles...
  Captured 5 url_access profiles
Capturing vulnerability_protection profiles...
  Captured 4 vulnerability_protection profiles
Capturing wildfire_anti_virus profiles...
  Captured 2 wildfire_anti_virus profiles
  Captured 32 profiles
    Authentication: 5
    Security: 24
    Decryption: 3
    [4/4] Capturing snippets
Capturing snippet: predefined-snippet (ID: 71bcabcb-ccb2-479a-8ec0-c02276295de7)
  ✓ Retrieved snippet details: predefined-snippet (ID: 71bcabcb-ccb2-479a-8ec0-c02276295de7)
  Snippet details:
    Name: predefined-snippet
    ID: 71bcabcb-ccb2-479a-8ec0-c02276295de7
    Shared in: local
    Folders: All
Capturing snippet: default (ID: 4fcb7572-2053-427e-8d4e-ce6a5b9b0f66)
  ✓ Retrieved snippet details: default (ID: 4fcb7572-2053-427e-8d4e-ce6a5b9b0f66)
  Snippet details:
    Name: default
    ID: 4fcb7572-2053-427e-8d4e-ce6a5b9b0f66
    Shared in: local
    Folders: All
Capturing snippet: optional-default (ID: d85c1ed9-7d31-4892-ba16-0475cef5571c)
  ✓ Retrieved snippet details: optional-default (ID: d85c1ed9-7d31-4892-ba16-0475cef5571c)
  Snippet details:
    Name: optional-default
    ID: d85c1ed9-7d31-4892-ba16-0475cef5571c
    Shared in: local
    Folders: Prisma Access
Capturing snippet: office365 (ID: 277d2f13-5282-411b-a98c-afd414e4bd22)
  ✓ Retrieved snippet details: office365 (ID: 277d2f13-5282-411b-a98c-afd414e4bd22)
  Snippet details:
    Name: office365
    ID: 277d2f13-5282-411b-a98c-afd414e4bd22
    Shared in: local
    Folders: Prisma Access
Capturing snippet: proxy (ID: 09fa1d33-3102-4fc7-8c56-92523ba29a80)
  ✓ Retrieved snippet details: proxy (ID: 09fa1d33-3102-4fc7-8c56-92523ba29a80)
  Snippet details:
    Name: proxy
    ID: 09fa1d33-3102-4fc7-8c56-92523ba29a80
    Shared in: local
    Folders: Mobile Users Explicit Proxy
Capturing snippet: rbi (ID: 92bcb468-2b21-4e10-a8b5-8ed66f66e9d1)
  ✓ Retrieved snippet details: rbi (ID: 92bcb468-2b21-4e10-a8b5-8ed66f66e9d1)
  Snippet details:
    Name: rbi
    ID: 92bcb468-2b21-4e10-a8b5-8ed66f66e9d1
    Shared in: local
    Folders: Prisma Access
Capturing snippet: saas-tenant-restrictions (ID: a4a36654-cf29-4a8f-aac9-fe85780d8e53)
  ✓ Retrieved snippet details: saas-tenant-restrictions (ID: a4a36654-cf29-4a8f-aac9-fe85780d8e53)
  Snippet details:
    Name: saas-tenant-restrictions
    ID: a4a36654-cf29-4a8f-aac9-fe85780d8e53
    Shared in: local
    Folders: Prisma Access
Capturing snippet: Auto-VPN-Default-Snippet (ID: eb47bfb9-5a83-4220-af06-50e92112f73b)
  ✓ Retrieved snippet details: Auto-VPN-Default-Snippet (ID: eb47bfb9-5a83-4220-af06-50e92112f73b)
  Snippet details:
    Name: Auto-VPN-Default-Snippet
    ID: eb47bfb9-5a83-4220-af06-50e92112f73b
    Shared in: local
    Folders: ngfw-shared
Capturing snippet: ZTP-Default-Snippet (ID: 4c449730-a6f4-4a91-95b7-853c2d5972aa)
  ✓ Retrieved snippet details: ZTP-Default-Snippet (ID: 4c449730-a6f4-4a91-95b7-853c2d5972aa)
  Snippet details:
    Name: ZTP-Default-Snippet
    ID: 4c449730-a6f4-4a91-95b7-853c2d5972aa
    Shared in: local
Capturing snippet: Web-Security-Default (ID: 26bb3fcb-103f-445e-948f-8064c71357f3)
  ✓ Retrieved snippet details: Web-Security-Default (ID: 26bb3fcb-103f-445e-948f-8064c71357f3)
  Snippet details:
    Name: Web-Security-Default
    ID: 26bb3fcb-103f-445e-948f-8064c71357f3
    Shared in: local
    Folders: All
Capturing snippet: hip-default (ID: 3fc115ab-cdf7-4a54-8073-dc6de42318d2)
  ✓ Retrieved snippet details: hip-default (ID: 3fc115ab-cdf7-4a54-8073-dc6de42318d2)
  Snippet details:
    Name: hip-default
    ID: 3fc115ab-cdf7-4a54-8073-dc6de42318d2
    Shared in: local
    Folders: All
Capturing snippet: Gen-AI-Best-Practice (ID: a19e4841-d781-4df3-9118-5405c262bd6c)
  ✓ Retrieved snippet details: Gen-AI-Best-Practice (ID: a19e4841-d781-4df3-9118-5405c262bd6c)
  Snippet details:
    Name: Gen-AI-Best-Practice
    ID: a19e4841-d781-4df3-9118-5405c262bd6c
    Shared in: local
Capturing snippet: app-tagging (ID: 3f177dbd-f6e5-43ce-935a-4d5abab7eb3c)
  ✓ Retrieved snippet details: app-tagging (ID: 3f177dbd-f6e5-43ce-935a-4d5abab7eb3c)
  Snippet details:
    Name: app-tagging
    ID: 3f177dbd-f6e5-43ce-935a-4d5abab7eb3c
    Shared in: local
Capturing snippet: Basic Internet Access (ID: 1350c7a1-b3ec-46c8-944c-65920a0509d3)
  ✓ Retrieved snippet details: Basic Internet Access (ID: 1350c7a1-b3ec-46c8-944c-65920a0509d3)
  Snippet details:
    Name: Basic Internet Access
    ID: 1350c7a1-b3ec-46c8-944c-65920a0509d3
    Shared in: local
    Folders: Prisma Access
Capturing snippet: dlp-predefined-snippet (ID: 2b97e183-2013-4b4a-8fea-dba61771eec5)
  ✓ Retrieved snippet details: dlp-predefined-snippet (ID: 2b97e183-2013-4b4a-8fea-dba61771eec5)
  Snippet details:
    Name: dlp-predefined-snippet
    ID: 2b97e183-2013-4b4a-8fea-dba61771eec5
    Shared in: local
    Folders: All
Capturing snippet: SAAS-Inline-Pol-Recommendation (ID: 7e0096a6-f34e-49bb-b23f-e89fdf92517e)
  ✓ Retrieved snippet details: SAAS-Inline-Pol-Recommendation (ID: 7e0096a6-f34e-49bb-b23f-e89fdf92517e)
  Snippet details:
    Name: SAAS-Inline-Pol-Recommendation
    ID: 7e0096a6-f34e-49bb-b23f-e89fdf92517e
    Shared in: local
Capturing snippet: Internet-Access-Best-Practice (ID: b34c71da-b184-44eb-bb49-e0ef48456fc5)
  ✓ Retrieved snippet details: Internet-Access-Best-Practice (ID: b34c71da-b184-44eb-bb49-e0ef48456fc5)
  Snippet details:
    Name: Internet-Access-Best-Practice
    ID: b34c71da-b184-44eb-bb49-e0ef48456fc5
    Shared in: local
Capturing snippet: DNS-Best-Practice (ID: 78154d92-3f27-4ea3-8626-b454f69ca9e3)
  ✓ Retrieved snippet details: DNS-Best-Practice (ID: 78154d92-3f27-4ea3-8626-b454f69ca9e3)
  Snippet details:
    Name: DNS-Best-Practice
    ID: 78154d92-3f27-4ea3-8626-b454f69ca9e3
    Shared in: local
Capturing snippet: AIRS-SLR-AWS-Default (ID: 8d6738c9-79d5-4027-b17b-5d68130e9fc4)
  ✓ Retrieved snippet details: AIRS-SLR-AWS-Default (ID: 8d6738c9-79d5-4027-b17b-5d68130e9fc4)
  Snippet details:
    Name: AIRS-SLR-AWS-Default
    ID: 8d6738c9-79d5-4027-b17b-5d68130e9fc4
    Shared in: local
Capturing snippet: AIRS-Best-Practice (ID: e8246da3-b8b4-4952-99c3-4c610d4fb43f)
  ✓ Retrieved snippet details: AIRS-Best-Practice (ID: e8246da3-b8b4-4952-99c3-4c610d4fb43f)
  Snippet details:
    Name: AIRS-Best-Practice
    ID: e8246da3-b8b4-4952-99c3-4c610d4fb43f
    Shared in: local
Capturing snippet: GCP-VM-Default (ID: 9f47b682-bae3-4025-9a89-2bcc0da0c578)
  ✓ Retrieved snippet details: GCP-VM-Default (ID: 9f47b682-bae3-4025-9a89-2bcc0da0c578)
  Snippet details:
    Name: GCP-VM-Default
    ID: 9f47b682-bae3-4025-9a89-2bcc0da0c578
    Shared in: local
Capturing snippet: Azure-VM-Default (ID: f9bddd98-c13d-4795-a70a-e3e89a8be8af)
  ✓ Retrieved snippet details: Azure-VM-Default (ID: f9bddd98-c13d-4795-a70a-e3e89a8be8af)
  Snippet details:
    Name: Azure-VM-Default
    ID: f9bddd98-c13d-4795-a70a-e3e89a8be8af
    Shared in: local
Capturing snippet: AWS-VM-Single-Arm-Default (ID: 759a8fb8-54af-41b2-bcb6-2921eaa80915)
  ✓ Retrieved snippet details: AWS-VM-Single-Arm-Default (ID: 759a8fb8-54af-41b2-bcb6-2921eaa80915)
  Snippet details:
    Name: AWS-VM-Single-Arm-Default
    ID: 759a8fb8-54af-41b2-bcb6-2921eaa80915
    Shared in: local
Capturing snippet: AWS-VM-Dual-Arm-Default (ID: 5df1b0dc-c3be-4dd8-9867-670f55f48927)
  ✓ Retrieved snippet details: AWS-VM-Dual-Arm-Default (ID: 5df1b0dc-c3be-4dd8-9867-670f55f48927)
  Snippet details:
    Name: AWS-VM-Dual-Arm-Default
    ID: 5df1b0dc-c3be-4dd8-9867-670f55f48927
    Shared in: local
Capturing snippet: AWS-VM-MCN-Default (ID: 0ba32db4-5ace-4f5d-8b14-cadf8c047378)
  ✓ Retrieved snippet details: AWS-VM-MCN-Default (ID: 0ba32db4-5ace-4f5d-8b14-cadf8c047378)
  Snippet details:
    Name: AWS-VM-MCN-Default
    ID: 0ba32db4-5ace-4f5d-8b14-cadf8c047378
    Shared in: local
Capturing snippet: Azure-VM-MCN-Default (ID: b4503649-9882-48b4-b42f-a8398481416a)
  ✓ Retrieved snippet details: Azure-VM-MCN-Default (ID: b4503649-9882-48b4-b42f-a8398481416a)
  Snippet details:
    Name: Azure-VM-MCN-Default
    ID: b4503649-9882-48b4-b42f-a8398481416a
    Shared in: local
Capturing snippet: Shared Internet (ID: 2af71204-1c51-498f-9533-cd83213347cc)
  ✓ Retrieved snippet details: Shared Internet (ID: 2af71204-1c51-498f-9533-cd83213347cc)
  Snippet details:
    Name: Shared Internet
    ID: 2af71204-1c51-498f-9533-cd83213347cc
    Shared in: local
    ✓ Captured 27 snippets

  Pull configuration validation:
    ✓ Folder: Mobile Users
    ✓ Security rules: 22
    ✓ Objects: 211
    ✓ Profiles: 32 (Auth: 5, Security: 24, Decryption: 3)
    ✓ Snippets: 27

  Pull report:
    Folders captured: 1
    Rules captured: 22
    Objects captured: 211
    Profiles captured: 32
    Snippets captured: 27

============================================================
Test 7: Config Pull
============================================================
✓ Config pull module structure correct

  Testing against real tenant...
  Testing pull_folders_only...
  Pulling 1 folder(s)...
  Using folder: Mobile Users
[1/1] Pulling folder Mobile Users
[1/3] Capturing rules from Mobile Users

  Config pull validation:
    ✓ Successfully pulled 1 folder configuration(s)

  Folder configuration details:
    Folder: Mobile Users
    Security rules: 22
    Objects: 0
    Profiles: 0 (Auth: 0, Security: 0, Decryption: 0)

============================================================
Test 8: Module Integration
============================================================
✓ All modules integrate correctly

  Testing orchestrator integration...

  Module integration validation:
    ✓ FolderCapture initialized
    ✓ RuleCapture initialized
    ✓ ObjectCapture initialized
    ✓ ProfileCapture initialized
    ✓ SnippetCapture initialized

  ✓ All capture modules initialized in orchestrator

============================================================
Test Summary
============================================================
Passed: 8/8

Note: Tests were run against a real tenant

✓ All tests passed!

Full test output saved to: Phase 2 Implementation Test-18.22.13-12.19.2025.txt

⚠ Note: Some errors were logged to: /home/lindsay/Code/pa_config_lab/api_errors.log
  (Errors may have been handled gracefully)
