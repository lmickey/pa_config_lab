
============================================================
Phase 2 Implementation Tests
============================================================

Output will be saved to: Phase 2 Implementation Test-18.01.46-12.19.2025.txt
Error log will be saved to: /home/lindsay/Code/pa_config_lab/api_errors.log


============================================================
Prisma Access Credentials
============================================================
Enter credentials to test against a real tenant.
Press Enter to skip and run structure tests only.

Note: For testing, use tenant tsg: 1570970024
      Use 'Mobile Users' folder for security policy testing.

Test against real tenant? (y/n): Enter TSG ID: Enter API Client ID: 
Credentials provided. Testing against real tenant...

Initializing API client...
âœ“ API client initialized successfully

============================================================
Test 1: Folder Capture
============================================================
âœ“ Folder capture module structure correct

  Testing against real tenant...
  âœ“ Discovered 13 folders
    - ngfw-shared (default: False)
    - Mobile Users (default: False)
    - Mobile Users Explicit Proxy (default: False)
    - Mobile Users Container (default: False)
    - Colo Connect (default: False)
    - Remote Networks (default: False)
    - Service Connections (default: False)
    - Prisma Access (default: False)
    - All (default: False)
    - Mobile User Container (default: False)
    - Access Agent (default: False)
    - GlobalProtect (default: False)
    - Explicit Proxy (default: False)

  Selected test folder: Mobile Users
    (This folder will be used for subsequent tests)
  âœ“ Built folder hierarchy (13 folders)
  âœ“ Listed 13 non-default folders for capture

============================================================
Test 2: Snippet Capture
============================================================
âœ“ Snippet capture module structure correct

  Testing against real tenant...
  âœ“ Discovered 27 snippets

  Snippet discovery validation:
    âœ“ Successfully discovered 27 snippet(s)

  Discovered snippets:
    - predefined-snippet (type: Unknown)
    - default (type: predefined)
    - optional-default (type: predefined)
    - office365 (type: predefined)
    - proxy (type: predefined)
    ... and 22 more

============================================================
Test 3: Rule Capture
============================================================
âœ“ Rule capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  âœ“ Captured 22 rules from Mobile Users

  Rule capture validation:
    âœ“ Successfully captured 22 rule(s)

  Example rule details:
    Name: Default Category Block
    Action: allow
    Position: pre
    Source: ['any']
    Destination: []

============================================================
Test 4: Object Capture
============================================================
âœ“ Object capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  âœ“ Captured 5 address objects
  âœ“ Captured 1 address groups
Capturing objects from folder: Mobile Users
  Captured 211 objects
    address_objects: 5
    address_groups: 1
    service_objects: 5
    applications: 200
  âœ“ Captured 211 total objects

  Object capture breakdown:
    address_objects: 5
    address_groups: 1
    service_objects: 5
    service_groups: 0
    applications: 200
    application_groups: 0
    application_filters: 0
    url_filtering_categories: 0
    external_dynamic_lists: 0
    fqdn_objects: 0

  Example address_objects object:
    Name: Palo Alto Networks Sinkhole
    Type: ip_netmask
    Description: Palo Alto Networks sinkhole

============================================================
Test 5: Profile Capture
============================================================
âœ“ Profile capture module structure correct

  Testing against real tenant...
  Testing with folder: Mobile Users
  âœ“ Captured 5 authentication profiles

  Example authentication profile:
    Name: CIE-Okta
    Type: 
Capturing profiles from folder: Mobile Users
Capturing anti_spyware profiles...
  Captured 2 anti_spyware profiles
Capturing dns_security profiles...
  Captured 3 dns_security profiles
Capturing file_blocking profiles...
  Captured 1 file_blocking profiles
Capturing http_header profiles...
  Captured 1 http_header profiles
Capturing profile_groups profiles...
  Captured 6 profile_groups profiles
Capturing url_access profiles...
  Captured 5 url_access profiles
Capturing vulnerability_protection profiles...
  Captured 4 vulnerability_protection profiles
Capturing wildfire_anti_virus profiles...
  Captured 2 wildfire_anti_virus profiles
  âœ— FAILED: Error capturing all profiles from folder Mobile Users
    Error type: AttributeError
    Error message: 'ProfileCapture' object has no attribute 'capture_all_decryption_profiles'

    Full traceback:
Traceback (most recent call last):
  File "/home/lindsay/Code/pa_config_lab/./test_phase2.py", line 531, in test_profile_capture
    all_profiles = profile_capture.capture_all_profiles(folder=test_folder)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/Code/pa_config_lab/prisma/pull/profile_capture.py", line 162, in capture_all_profiles
    'decryption_profiles': self.capture_all_decryption_profiles(folder)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ProfileCapture' object has no attribute 'capture_all_decryption_profiles'. Did you mean: 'capture_decryption_profiles'?

âš  Test test_profile_capture returned False

============================================================
Test 6: Pull Orchestrator
============================================================
âœ“ Pull orchestrator module structure correct

  Testing against real tenant...
  Testing pull with folder: Mobile Users
    [1/3] Capturing rules from Mobile Users
    [2/3] Capturing objects from Mobile Users
Capturing objects from folder: Mobile Users
  Captured 211 objects
    address_objects: 5
    address_groups: 1
    service_objects: 5
    applications: 200
    [3/3] Capturing profiles from Mobile Users
Capturing profiles from folder: Mobile Users
Capturing anti_spyware profiles...
  Captured 2 anti_spyware profiles
Capturing dns_security profiles...
  Captured 3 dns_security profiles
Capturing file_blocking profiles...
  Captured 1 file_blocking profiles
Capturing http_header profiles...
  Captured 1 http_header profiles
Capturing profile_groups profiles...
  Captured 6 profile_groups profiles
Capturing url_access profiles...
  Captured 5 url_access profiles
Capturing vulnerability_protection profiles...
  Captured 4 vulnerability_protection profiles
Capturing wildfire_anti_virus profiles...
  Captured 2 wildfire_anti_virus profiles
Error: Error pulling folder Mobile Users - 'ProfileCapture' object has no attribute 'capture_all_decryption_profiles'

  Pull configuration validation:
    âœ“ Folder: Mobile Users
    âœ“ Security rules: 22
    âœ“ Objects: 10
    âœ“ Profiles: 0

  Pull report:
    Folders captured: 0
    Rules captured: 22
    Objects captured: 211
    Profiles captured: 0
    Snippets captured: 0

  âš  WARNING: 1 errors occurred during pull:
    - Error pulling folder Mobile Users

============================================================
Test 7: Config Pull
============================================================
âœ“ Config pull module structure correct

  Testing against real tenant...
  Testing pull_folders_only...
  Pulling 1 folder(s)...
  Using folder: Mobile Users
[1/1] Pulling folder Mobile Users
[1/3] Capturing rules from Mobile Users

  Config pull validation:
    âœ“ Successfully pulled 1 folder configuration(s)

  Folder configuration details:
    Folder: Mobile Users
    Security rules: 22
    Objects: 0
    Profiles: 0

============================================================
Test 8: Module Integration
============================================================
âœ“ All modules integrate correctly

  Testing orchestrator integration...

  Module integration validation:
    âœ“ FolderCapture initialized
    âœ“ RuleCapture initialized
    âœ“ ObjectCapture initialized
    âœ“ ProfileCapture initialized
    âœ“ SnippetCapture initialized

  âœ“ All capture modules initialized in orchestrator

============================================================
Test Summary
============================================================
Passed: 7/8

Note: Tests were run against a real tenant

âœ— 1 test(s) failed

Full test output saved to: Phase 2 Implementation Test-18.01.46-12.19.2025.txt

ðŸ“‹ Detailed error log available at: /home/lindsay/Code/pa_config_lab/api_errors.log

============================================================
Error Log Summary
============================================================
====================================================================================================
API ERROR LOG - Test Run Started
Test: Phase 2 Implementation Tests
Timestamp: 2025-12-19 18:01:46
====================================================================================================


----------------------------------------------------------------------------------------------------
CAPTURE ERROR - 2025-12-19 18:02:44
----------------------------------------------------------------------------------------------------

Operation: capture_all_profiles
Context: Mobile Users
Error Type: AttributeError
Error Message: 'ProfileCapture' object has no attribute 'capture_all_decryption_profiles'

Traceback:
Traceback (most recent call last):
  File "/home/lindsay/Code/pa_config_lab/./test_phase2.py", line 531, in test_profile_capture
    all_profiles = profile_capture.capture_all_profiles(folder=test_folder)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lindsay/Code/pa_config_lab/prisma/pull/profile_capture.py", line 162, in capture_all_profiles
    'decryption_profiles': self.capture_all_decryption_profiles(folder)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ProfileCapture' object has no attribute 'capture_all_decryption_profiles'. Did you mean: 'capture_decryption_profiles'?

----------------------------------------------------------------------------------------------------


====================================================================================================
Test Run Ended
Timestamp: 2025-12-19 18:02:44
Duration: 58.12 seconds
Summary: Tests: 7/8 passed
====================================================================================================


